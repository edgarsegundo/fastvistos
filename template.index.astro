---
import BlogLayout from '../../layouts/BlogLayout.astro';

const allPosts = import.meta.glob('../../content/blog/*.md', { eager: true });
const posts = Object.entries(allPosts).map(([path, post]) => ({
  ...(post as any),
  slug: path.split('/').pop()?.replace('.md', '') || ''
}));
---

<BlogLayout 
    title="Blog - FastVistos | Dicas sobre Vistos Americanos" 
    description="Artigos e dicas sobre como obter vistos americanos, eTA canadense e vistos mexicanos. Guias completos e atualizados."
>


    <!-- H1 -->
    <section class="bg-black py-20 px-4 lg:px-8">
        <div class="mx-auto" style="max-width: 1220px;">
            <div class="">
                <!-- Main Title -->
                <h1 class="text-2xl md:text-4xl font-bold text-white leading-tight">Dicas e Not√≠cias sobre Vistos</h1>
                <!-- Breadcrumb -->
                <div class="mb-2 mt-6">
                    <nav class="text-sm">
                        <ol class="flex items-center text-white font-medium text-xl" style="font-size: 1.03rem;">
                            <li class="flex items-center">
                                <a href="https://fastvistos.com.br" class="hover:text-gray-300">Home</a>
                                <span class="mx-2 text-gray-400">|</span>
                            </li>
                            <li class="">
                                <a href="../blog.html" class="hover:text-gray-300">Blog</a>
                            </li>
                        </ol>
                    </nav>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Blog Content -->
    <main class="container mx-auto py-10 px-4">
        <style>
            /* Hide scrollbar but keep functionality */
            .carousel-container::-webkit-scrollbar {
                display: none;
            }
            .carousel-container {
                -ms-overflow-style: none;
                scrollbar-width: none;
            }
            
            /* Smooth scroll behavior */
            .carousel-container {
                scroll-behavior: smooth;
            }
        </style>

        {% for post in blog_data.carousel %}
        <section class="relative mt-12">

            <!-- Carousel Container -->
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">

                <h2 id="{{ post.slug or post.id }}" class="text-3xl font-semibold mb-8">
                    {{ post.section }}
                </h2>
    

                <div class="relative pt-8">

                    <!-- Carousel Content -->
                    <div 
                        id="carousel-{{ post.slug or post.id }}" 
                        class="carousel-container flex gap-6 overflow-x-auto pb-4 pt-4 px-4"
                    >
                        {% for q in post.questions %}
                        <article class="bg-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300 hover:scale-105 flex-shrink-0 w-80">
                            <img 
                                src="{{ q.image or 'https://via.placeholder.com/400x250' }}" 
                                alt="{{ q.slug }}" 
                                class="w-full h-48 object-cover rounded-t-lg"
                            >
                            <div class="p-6">
                                <h3 class="text-xl font-semibold mb-2">{{ q.question[:70] }}</h3>
                                <p class="text-gray-600 mb-4">
                                    {{ q.answer[:90] }}{% if q.answer|length > 90 %}...{% endif %}
                                </p>
                                <a href="{{ post.slug }}/{{ q.slug }}.html" class="text-blue-600 hover:underline font-medium">
                                    Leia mais
                                </a>
                            </div>
                        </article>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </section>
        {% endfor %}

        <script>
            // Get carousel elements
            const carousel = document.getElementById('carousel');
            
            // Scroll amount (width of one card plus gap)
            const scrollAmount = 320; // 320px (card width) + 24px (gap)
            
            // Optional: Add keyboard navigation
            document.addEventListener('keydown', function(e) {
                if (e.key === 'ArrowLeft') {
                    carousel.scrollBy({
                        left: -scrollAmount,
                        behavior: 'smooth'
                    });
                } else if (e.key === 'ArrowRight') {
                    carousel.scrollBy({
                        left: scrollAmount,
                        behavior: 'smooth'
                    });
                }
            });
            
            // Optional: Add touch/swipe support for mobile
            let startX = 0;
            let scrollStart = 0;
            
            carousel.addEventListener('touchstart', function(e) {
                startX = e.touches[0].clientX;
                scrollStart = carousel.scrollLeft;
            });
            
            carousel.addEventListener('touchmove', function(e) {
                if (!startX) return;
                
                const currentX = e.touches[0].clientX;
                const diff = startX - currentX;
                carousel.scrollLeft = scrollStart + diff;
            });
            
            carousel.addEventListener('touchend', function() {
                startX = 0;
                scrollStart = 0;
            });
        </script>
    </main>



</BlogLayout>

---
const {
  alt,
  width = 608,
  height = 405,
  sizes,
  sources = {},
  blurDataURL,
  priority = false,
  class: className = ""
} = Astro.props;

// Pega o primeiro JPEG da lista, sem tentar dividir por espa√ßo
const fallbackSrc = sources.jpeg?.split(",")[0].trim() || "";
---

<picture
  class={`relative block ${className}`}
  style={
    blurDataURL
      ? `background-image:url('${blurDataURL}'); background-size:cover; background-position:center;`
      : undefined
  }
>
  {sources.webp && (
    <source type="image/webp" srcset={sources.webp} sizes={sizes} />
  )}

  {sources.jpeg && (
    <source type="image/jpeg" srcset={sources.jpeg} sizes={sizes} />
  )}

  <img
    src={fallbackSrc}
    alt={alt}
    width={width}
    height={height}
    sizes={sizes}
    srcset={sources.jpeg}
    loading={priority ? "eager" : "lazy"}
    decoding="async"
    class="w-full h-full object-cover"
  />
</picture>

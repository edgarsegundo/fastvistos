---
const {
  alt,
  width,
  height,
  sizes,
  sources = {},
  blurDataURL,
  priority = false,
  class: className = ""
} = Astro.props;

// Fallback = blur (1 sรณ vez, muito leve)
const fallbackSrc = blurDataURL;
---
<picture
  class={`relative block ${className}`}
  style={`background-image:url('${blurDataURL}'); background-size:cover; background-position:center;`}
>
  {sources.webp && (
    <source type="image/webp" srcset={sources.webp} sizes={sizes} />
  )}

  {sources.jpeg && (
    <source type="image/jpeg" srcset={sources.jpeg} sizes={sizes} />
  )}

  <img
    src={fallbackSrc}
    alt={alt}
    width={width}
    height={height}
    loading={priority ? "eager" : "lazy"}
    decoding="async"
    class="w-full h-full object-cover transition-opacity duration-300"
    style="opacity:0;"
    onload="this.style.opacity='1'"
  />
</picture>

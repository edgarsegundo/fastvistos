---
// Props esperadas:
// alt: texto
// width, height: dimensões
// sizes: string para atributo sizes
// sources: { avif, webp, jpeg } (srcset já pronto)
// blurDataURL: string base64 para placeholder
// priority: boolean (opcional)
// class: classes extras

const {
  alt,
  width,
  height,
  sizes,
  sources = {},
  blurDataURL,
  priority = false,
  class: className = ""
} = Astro.props;

// Log props para debug
console.log("[ResponsiveImage] alt:", alt);
console.log("[ResponsiveImage] width:", width);
console.log("[ResponsiveImage] height:", height);
console.log("[ResponsiveImage] sizes:", sizes);
console.log("[ResponsiveImage] sources:", sources);
console.log("[ResponsiveImage] blurDataURL:", blurDataURL);
console.log("[ResponsiveImage] priority:", priority);
console.log("[ResponsiveImage] class:", className);
---

<picture class={className}>
  {sources.avif && (
    <source type="image/avif" srcset={sources.avif} sizes={sizes} />
  )}
  {sources.webp && (
    <source type="image/webp" srcset={sources.webp} sizes={sizes} />
  )}
  {sources.jpeg && (
    <source type="image/jpeg" srcset={sources.jpeg} sizes={sizes} />
  )}
  <img
    src={sources.jpeg?.split(',')[0]?.split(' ')[0] || ''}
    alt={alt}
    width={width}
    height={height}
    loading={priority ? "eager" : "lazy"}
    decoding="async"
    class={`w-full h-full object-cover ${className}`}
    style={blurDataURL ? `background: url('${blurDataURL}'); background-size: cover;` : undefined}
  />
</picture>

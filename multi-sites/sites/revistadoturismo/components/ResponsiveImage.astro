---
const {
  alt,
  width,
  height,
  sizes,
  sources = {},
  blurDataURL,
  priority = false,
  class: className = ""
} = Astro.props;

const fallbackSrc = sources.jpeg?.split(",")[0]?.trim().split(" ")[0] || "";
---
<picture
  class={`relative block ${className}`}
  style={blurDataURL ? `background-image:url('${blurDataURL}'); background-size:cover; background-position:center;` : undefined}
>
  {sources.webp && (
    <source type="image/webp" srcset={sources.webp} sizes={sizes} />
  )}
  {sources.jpeg && (
    <source type="image/jpeg" srcset={sources.jpeg} sizes={sizes} />
  )}

  <img
    src={fallbackSrc}
    alt={alt}
    width={width}
    height={height}
    loading={priority ? "eager" : "lazy"}
    decoding="async"
    class="w-full h-full object-cover"
  />
</picture>

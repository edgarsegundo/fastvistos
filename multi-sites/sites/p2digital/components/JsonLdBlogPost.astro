---
/**
 * JsonLdBlogPost.astro
 * Unificado: não depende mais de JsonLdArticleBase.astro. Inclui mentions, interactionStatistic, comment, etc.
 */

/**
 * JsonLdBlogPost.astro
 * Gera JSON-LD para um BlogPosting (artigo/post), extensível com mentions, interactionStatistic, comment, etc.
 */
export interface Props {
  article: {
    id: string;
    title: string;
    description: string;
    url: string;
    datePublished: string;
    dateModified?: string;
    image?: string;
    author: { id: string; name: string; url?: string; sameAs?: string[] };
    publisher: { id: string; name: string; logo?: string };
    section?: string[];
    inLanguage?: string;
  };
  mentions?: any[];
  interactionStatistic?: any[];
  comment?: any[];
  extraGraph?: any[];
  customData?: any;
}
const {
  article,
  mentions = [],
  interactionStatistic = [],
  comment = [],
  extraGraph = [],
  customData
} = Astro.props;

const baseGraph = [
  {
    "@type": "Person",
    "@id": article.author.id,
    "name": article.author.name,
    "url": article.author.url,
    "sameAs": article.author.sameAs
  },
  {
    "@type": "Organization",
    "@id": article.publisher.id,
    "name": article.publisher.name,
    "logo": article.publisher.logo
  },
  {
    "@type": "BlogPosting",
    "@id": article.id,
    "headline": article.title,
    "description": article.description,
    "author": { "@id": article.author.id },
    "publisher": { "@id": article.publisher.id },
    "datePublished": article.datePublished,
    "dateModified": article.dateModified || article.datePublished,
    "image": article.image,
    "articleSection": article.section,
    "inLanguage": article.inLanguage,
    "mainEntityOfPage": { "@id": article.url }
  }
];
const advancedGraph = [
  ...(mentions.length ? [{ "mentions": mentions }] : []),
  ...(interactionStatistic.length ? [{ "interactionStatistic": interactionStatistic }] : []),
  ...(comment.length ? [{ "comment": comment }] : []),
  ...extraGraph
];
const graph = [...baseGraph, ...advancedGraph];
const jsonLd = customData ? customData : { "@context": "https://schema.org", "@graph": graph };
---
<script type="application/ld+json" set:html={JSON.stringify(jsonLd, null, 2)} />

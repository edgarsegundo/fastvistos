---
import { getValidatedImageUrl } from '../lib/utils.ts';
import { siteConfig } from '../site-config.ts';

export function getImageObjectBlock({
    disableImageObject,
    imageId,
    image,
    imageUrl,
    caption,
    width,
    height,
}: {
    disableImageObject: boolean;
    imageId?: string | null;
    image?: string | null;
    imageUrl?: string;
    caption?: string;
    width?: number;
    height?: number;
}) {
    if (disableImageObject || (!imageUrl && !siteConfig.site?.image && !image)) return null;

    const imageUrlValidated = getValidatedImageUrl({
        image,
        imageUrl,
        assetsUrlBase: siteConfig.site.assetsUrlBase
    });

    return {
        '@type': 'ImageObject',
        inLanguage: siteConfig.site?.locale || 'pt_BR',
        '@id': imageId,
        url: imageUrlValidated,
        contentUrl: imageUrlValidated,
        ...(caption ? { caption } : {}),
        ...(width ? { width } : {}),
        ...(height ? { height } : {}),
    };
}
---
